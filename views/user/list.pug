extends ../layout

block content
  script.
    $(document).ready(function() {
      $('.status-select').change(function() {
        $.ajax({
          type: 'POST',
          url: '/releases/status_change',
          data: $(this).parent().parent().serialize()
        });
      });
    });


  div.content
    table.list
      tr.header
        td(width='100px') <p>Release Date</p>
        td(width='60px') <p>Region</p>
        td(width='200px') <p>Version</p>
        td <p>Type</p>
        td(width='50%') <p>Title</p>
        td(width='200px')

      each r in list.releases
        tr
          td
            if r.release_date
              p= r.release_date
            else
              p.subdued Unknown

          td <p>#{r.region}</p>
          td <p>#{r.version}</p>
          td <p>#{r.type}</p>

          td
            p
              | <a href='/releases/#{r.id}'>#{r.title}
              if r.title_romaji
                | &nbsp;<span class='subdued'>(#{r.title_romaji})</span>
              | </a>

          td
            form
              input(type='hidden' name='release_id' value=r.id)

              p.right
                if user
                  | <select class='status-select' name='status'>
                  each o in ['Status?', 'Backlog', 'Playing', 'Completed']
                    if o == r.status
                      | <option value='#{o}' selected='selected'>#{o}</option>
                    else
                      | <option value='#{o}'>#{o}</option>
                  | </select>
                | <a class='special' href='/releases/edit/#{r.id}'>Edit</a>
